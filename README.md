# Mad2Moi Blog Platform

A full-stack blog platform with admin dashboard, AI-powered content generation, and real-time chat support.

## 🏗️ Architecture

This project consists of two main applications:

- **Blog**: Public-facing blog built with Astro (`/blog`)
- **Admin**: Administrative dashboard built with Astro + React (`/adminblog`)

## 🚀 Quick Start (Local Development)

### Prerequisites

- Node.js 18+ 
- npm or yarn
- MongoDB Atlas account (for chat system)
- OpenAI API key (for AI features)

### Installation

1. **Clone the repository**
   ```bash
   git clone <your-repo-url>
   cd danialblogs-chat_work
   ```

2. **Install dependencies**
   ```bash
   # Admin Dashboard
   cd adminblog
   npm install

   # Blog
   cd ../blog  
   npm install
   ```

3. **Configure environment variables**
   ```bash
   # Copy the example config
   cp config.env .env
   
   # Edit .env with your values:
   # - OPENAI_API_KEY: Your OpenAI API key
   # - MONGO_URI: Your MongoDB connection string
   # - Generate secure secrets for JWT and sessions
   ```

4. **Initialize databases**
   ```bash
   cd adminblog
   npm run setup
   ```

5. **Start development servers**
   ```bash
   # Terminal 1: Admin Dashboard
   cd adminblog
   npm run dev

   # Terminal 2: Blog
   cd blog
   npm run dev
   ```

Visit:
- Blog: http://localhost:4321
- Admin: http://localhost:4322

## 🌍 Deployment on Render

### Automatic Deployment

This project includes a `render.yaml` configuration for easy deployment:

1. **Push to GitHub**
   ```bash
   git init
   git add .
   git commit -m "Initial commit"
   git remote add origin <your-github-repo>
   git push -u origin main
   ```

2. **Deploy on Render**
   - Go to [Render Dashboard](https://dashboard.render.com)
   - Click "New +" → "Blueprint"
   - Connect your GitHub repository
   - Render will automatically detect `render.yaml` and deploy both services

3. **Configure Environment Variables**
   
   Set these in the Render dashboard for each service:

   **Admin Service:**
   - `OPENAI_API_KEY`: Your OpenAI API key
   - `MONGO_URI`: Your MongoDB Atlas connection string
   - Other secrets are auto-generated by Render

   **Blog Service:**
   - No additional config needed

### Manual Deployment

If you prefer manual deployment:

1. **Admin Dashboard**
   - Service Type: Web Service
   - Build Command: `cd adminblog && npm install && npm run build`
   - Start Command: `cd adminblog && npm start`

2. **Blog**
   - Service Type: Web Service  
   - Build Command: `cd blog && npm install && npm run build`
   - Start Command: `cd blog && npm start`

## ⚙️ Environment Variables

| Variable | Description | Required | Default |
|----------|-------------|----------|---------|
| `OPENAI_API_KEY` | OpenAI API key for AI features | Yes | - |
| `MONGO_URI` | MongoDB connection string | Yes | - |
| `ADMIN_JWT_SECRET` | JWT signing secret | Yes | Auto-generated |
| `ADMIN_SESSION_SECRET` | Session secret | Yes | Auto-generated |
| `BLOG_REBUILD_TOKEN` | Webhook security token | Yes | Auto-generated |
| `NODE_ENV` | Environment | No | `production` |
| `DB_DRIVER` | Database driver | No | `sqlite` |

## 📊 Features

### Blog Features
- ✅ Responsive design
- ✅ SEO optimized
- ✅ RSS feed
- ✅ Article categories and tags
- ✅ Reading time estimates
- ✅ Image optimization
- ✅ Live chat widget

### Admin Features
- ✅ User management
- ✅ Article CRUD operations
- ✅ AI-powered content generation
- ✅ Real-time chat support
- ✅ Analytics dashboard
- ✅ Media management
- ✅ Settings configuration

### AI Features
- ✅ GPT-powered article generation
- ✅ Custom article sizes (600/1500/3000 words)
- ✅ AI image generation
- ✅ Chat auto-responses
- ✅ Content suggestions

## 🔒 Security Notes

### Before Deployment:
- ✅ All hardcoded API keys have been removed
- ✅ Environment variables are properly configured
- ✅ Sensitive files are in `.gitignore`
- ✅ MongoDB credentials are secured

### Production Checklist:
- [ ] Change all default passwords
- [ ] Use strong JWT secrets
- [ ] Enable HTTPS
- [ ] Configure CORS properly
- [ ] Set up monitoring
- [ ] Configure backups

## 🔧 Development

### Database Setup
The admin uses SQLite by default for simplicity. MongoDB is used for the chat system.

### API Endpoints
- `/api/articles` - Article management
- `/api/users` - User management  
- `/api/chat-stream` - Chat system
- `/api/session` - Authentication

### File Structure
```
├── adminblog/          # Admin dashboard
│   ├── public/         # Static assets
│   ├── src/           # Source code
│   └── scripts/       # Database utilities
├── blog/              # Public blog
│   ├── public/        # Static assets
│   └── src/          # Source code
└── config.env        # Environment config
```

## 🐛 Troubleshooting

### Common Issues

1. **Port conflicts**
   - Admin runs on port 4322
   - Blog runs on port 4321
   - Make sure ports are available

2. **Database connection errors**
   - Check MongoDB URI is correct
   - Ensure network access is allowed
   - Verify credentials

3. **OpenAI API errors**
   - Check API key is valid
   - Verify you have sufficient credits
   - Check rate limits

### Support

For issues and questions:
- Check the console for error messages
- Verify environment variables are set
- Ensure all dependencies are installed

## 📝 License

MIT License - see LICENSE file for details
